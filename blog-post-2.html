<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
    <title>BreezyCV - Resume / CV / vCard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="BreezyCV - Resume / CV / vCard Template" />
    <meta name="keywords" content="vcard, resposnive, retina, resume, jquery, css3, bootstrap, portfolio" />
    <meta name="author" content="lmpixels" />
    <link rel="shortcut icon" href="favicon.ico">


    <link rel="stylesheet" href="css/reset.css" type="text/css">
    <link rel="stylesheet" href="css/bootstrap-grid.min.css" type="text/css">
    <link rel="stylesheet" href="css/animations.css" type="text/css">
    <link rel="stylesheet" href="css/perfect-scrollbar.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.css" type="text/css">
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="css/main.css" type="text/css">

    <script src="js/modernizr.custom.js"></script>
  </head>

  <body>
    <!-- Animated Background -->
    <div class="lm-animated-bg" style="background-image: url(img/main_bg.png);"></div>
    <!-- /Animated Background -->

    <!-- Loading animation -->
    <div class="preloader">
      <div class="preloader-animation">
        <div class="preloader-spinner">
        </div>
      </div>
    </div>
    <!-- /Loading animation -->

    <div class="page">
      <div class="page-content">

          <header id="site_header" class="header mobile-menu-hide">
            <div class="header-content">
              <div class="header-photo">
                <img src="img/main_photo.jpg" alt="Alex Smith">
              </div>
              <div class="header-titles">
                <h2>Hai-Tao Li</h2>
                <h4>Ph.D. candidate • BIOINFORMATICS</h4>
              </div>
            </div>

            <ul class="main-menu">
              <li class="active">
                <a href="index.html#about-me" class="nav-anim">
                  <span class="menu-icon lnr lnr-home"></span>
                  <span class="link-text">About Me</span>
                </a>
              </li>
              <li>
                <a href="index.html#resume" class="nav-anim">
                  <span class="menu-icon lnr lnr-graduation-hat"></span>
                  <span class="link-text">Resume</span>
                </a>
              </li>
              <li> </li>
              <li>
                <a href="index.html#blog" class="nav-anim">
                  <span class="menu-icon lnr lnr-book"></span>
                  <span class="link-text">Blog</span>
                </a>
              </li>
              <li>
                <a href="index.html#contact" class="nav-anim">
                  <span class="menu-icon lnr lnr-envelope"></span>
                  <span class="link-text">Contact</span>
                </a>
              </li>
            </ul>

            <div class="social-links">
              <ul>
  				<li><a href="#" target="_blank"><i class="fab fa-weixin"></i></a></li>
                <li><a href="mailto:leehightall@163.com" target="_blank"><i class="fa fa-envelope-open"></i></a></li>
                <li><a href="#" target="_blank"><i class="fab fa-qq"></i></a></li>
              </ul>
            </div>

            <div class="header-buttons">
              <a href="./paper/Haitao_Li-CV.docx" target="_blank" class="btn btn-primary">Download CV</a>
            </div>
          
          </header>

          <!-- Mobile Navigation -->
          <div class="menu-toggle">
            <span></span>
            <span></span>
            <span></span>
          </div>
          <!-- End Mobile Navigation -->

          <div class="content-area single-page-area">
            <div class="single-page-content">

              <article class="post">

                <div class="post-thumbnail">
                  <img src="img/fengmian.jpg" alt="image" width="1500" height="400">
                </div>

                <div class="post-content">
                  <!-- /Entry header -->
                  <header class="entry-header">
                    <!-- Entry meta -->
                    <div class="entry-meta entry-meta-top">
                      <span><a href="#" rel="category tag">Bioinformatics Tools</a></span>        
                    </div>
                    <!-- /Entry meta -->

                    <h2 class="entry-title" align="middle">IMPUTE2基因型填充详细过程(2)</h2>
                  </header>
                  <!-- /Entry header -->

                  <!-- Entry content -->
                  <div class="entry-content">
                    <div class="row">
                      <div class=" col-xs-12 col-sm-12 ">
                        <div class="col-inner">
                          <h3>四、根据上面对于impute2数据的介绍，需要对程序运行前的文件进行预处理。</h3>
<h4>1、参考序列的预处理</h4>
<p>在impute2网页：https://mathgen.stats.ox.ac.uk/impute/data_download_1000G_ phase1_integrated.html。下载这个数据作为参考序列：</p>
    <p><img src="img/Blog_1/image007.png" >&nbsp;</img></p>
<p>下载参考序列reference名称为：ALL_1000G_phase1integrated_v3_impute _macGT1.hap.gz和ALL_1000G_phase1integrated_v3_impute_macGT1.legend.gz。</p>
<p>由于impute2执行程序时，.legend格式只有前四列，因此见文件解压后仅保留文件前四列即可，同时将染色体分开，将文件保存于/mnt/disk/yuanshx/data_files/ALL_1000G_phase1integrated_v3_ impute_macGT1中，命名为ALL_1000G_phase1integrated_v3_chrXX_impute_macGT1_column4.legend和ALL_1000G_phase1integrated_v3_chr1_impute_macGT1.hap.gz</p>
 
<h4>2、由于impute2可以对每段染色体进行并行运行，因此这里将染色体按照5M长度进行分段。</h4>
<p>格式为</p>
<blockquote class="quote"><p>start  	end</p>
<p>1		5000000</p>
<p>5000001	10000000 ……</p></blockquote>
<p>命名为 analysis_chunks_5Mb_chr(n).txt，文件存储在/mnt/disk/yuanshx/data_files中。</p>
<h4>3、遗传图文件（Genetic map file）——该文件包含基因位置（例如重组率的精确刻度）。</h4>
<p>该文件被用来设置IMPUTE2的隐马尔可夫参数。遗传图文件对于所有的人类的常基因组数据可以下载，名称为：genetic_map_b36_combined.tgz。示例中为：genetic_map_chr10_combined_ b36.txt</p>
 
<h4>4、使用SHAPEIT处理后的phase后数据，存储在/mnt/disk/hightall/impute_SNP/AD_MCI/results_shapeit中。</h4>

<p>通过以上四组预备文件准备好，使用impute2软件对数据进行处理，处理的程序可见：http://genome.sph.umich.edu/wiki/IMPUTE2:_1000_Genomes_Imputation_ Cookbook#Imputation。需要修改文件中数据地址。</p>

<p>使用impute2处理后，生成的文件如下图所示</p>
     <p><img src="img/Blog_1/image009.png" >&nbsp;</img></p>

<p>填充完成的数据保存在后缀为.impute2的文件中，文件存储在/mnt/disk/hightall/impute_SNP/AD_MCI/results_impute2中。具体结果如下图所示：</p>
 <p><img src="img/Blog_1/image011.png" >&nbsp;</img></p>
<p>其中第一列为染色体数字为原文件中存在的位点，也就是需要填充的位点，假设有m个样本（患者），每一行一共有（5+3m）维，其中5列之后每3个数据组成一个样本的基因型的概率分别为（AA，Aa和aa）的概率，因此之和为1.</p>
<p>后续的处理需要将这些列提取出来，还原为可直接处理的数据。</p>

<h3>五、对处理后的文件进行</h3>
<p>1、首先整合在提取时分割的位点，并且提取填充文件原有的SNP位点(以1号染色体为例)</p>
<blockquote class="quote">cat *.impute2 | grep ^1 > chr1_grep.gen</blockquote>
<p>2、将每条染色体使用gtool进行整理，合成.ped和.map文件。</p>
<blockquote class="quote">gtool -G --g chr1_grep.gen --s /mnt/disk/hightall/impute_SNP/AD_MCI/ results_shapeit/chr1_shapeit.sample \
--ped chr1_imputed.ped --map chr1_imputed.map \
--snp --phenotype plink_pheno</blockquote>
<p>3、将各个染色体的文件通过plink进行整合。</p>
<blockquote class="quote">touch allfiles.txt
for chr in {1..22};
do plink --file chr${chr}_imputed --merge-list allfiles.txt --make-bed --out ad_nc;
done</blockquote>
<p>最后生成填充后的.bed/.fam/.bin。</p>
<p>后面可以对这些数据进行进一步的处理。</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /Entry content -->
    
                  <div class="entry-meta entry-meta-bottom">
                    <div class="date-author"><span class="entry-date"> <a href="#" rel="bookmark"> <em class="far fa-clock"></em> <span class="entry-date"> March 18, 2017</span> </a> </span> <span class="author vcard"> <a class="url fn n" href="#" rel="author"> <em class="fas fa-user"></em> Hai-Tao Li</a> </span></div>
      
                    <!-- Share Buttons -->
                    <div class="entry-share btn-group share-buttons"> </div>
                    <!-- /Share Buttons -->
                  </div>

                  <div class="post-tags">
                    <div class="tags">
                      <a href="#" rel="tag">SNP</a>
                      <a href="#" rel="tag">Impute2</a>
                      <a href="#" rel="tag">genotype</a>
                      <a href="#" rel="tag">bioinformatics tool</a>
                      <a href="#" rel="tag">GWAS</a>
                    </div>
                  </div>
                </div>
              </article>

            </div>
          </div>

      </div>
    </div>

    <script src="js/jquery-2.1.3.min.js"></script>
    <script src="js/modernizr.custom.js"></script>
    <script src="js/animating.js"></script>

    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>

    <script src='js/perfect-scrollbar.min.js'></script>
    <script src='js/jquery.shuffle.min.js'></script>
    <script src='js/masonry.pkgd.min.js'></script>
    <script src='js/owl.carousel.min.js'></script>
    <script src="js/jquery.magnific-popup.min.js"></script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrDf32aQTCVENBhFJbMBKOUTiUAABtC2o"></script>
    <script src="js/jquery.googlemap.js"></script>
    <script src="js/validator.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
