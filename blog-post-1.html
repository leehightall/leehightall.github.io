<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
    <title>Hai-tao Li</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Li Hai-tao - Resume and CV" />
    <meta name="keywords" content="resume, Bioinformatics, CV" />
    <meta name="author" content="lmpixels" />
    <link rel="shortcut icon" href="favicon.ico">


    <link rel="stylesheet" href="css/reset.css" type="text/css">
    <link rel="stylesheet" href="css/bootstrap-grid.min.css" type="text/css">
    <link rel="stylesheet" href="css/animations.css" type="text/css">
    <link rel="stylesheet" href="css/perfect-scrollbar.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.css" type="text/css">
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="css/main.css" type="text/css">

    <script src="js/modernizr.custom.js"></script>
  </head>

  <body>
    <!-- Animated Background -->
    <div class="lm-animated-bg" style="background-image: url(img/main_bg.png);"></div>
    <!-- /Animated Background -->

    <!-- Loading animation -->
    <div class="preloader">
      <div class="preloader-animation">
        <div class="preloader-spinner">
        </div>
      </div>
    </div>
    <!-- /Loading animation -->

    <div class="page">
      <div class="page-content">

          <header id="site_header" class="header mobile-menu-hide">
            <div class="header-content">
              <div class="header-photo">
                <img src="img/main_photo.jpg" alt="Alex Smith">
              </div>
              <div class="header-titles">
                <h2>Hai-Tao Li</h2>
                <h4>Ph.D. candidate • BIOINFORMATICS</h4>
              </div>
            </div>

            <ul class="main-menu">
              <li class="active">
                <a href="index.html#about-me" class="nav-anim">
                  <span class="menu-icon lnr lnr-home"></span>
                  <span class="link-text">About Me</span>
                </a>
              </li>
              <li>
                <a href="index.html#resume" class="nav-anim">
                  <span class="menu-icon lnr lnr-graduation-hat"></span>
                  <span class="link-text">Resume</span>
                </a>
              </li>
              <li> </li>
              <li>
                <a href="index.html#blog" class="nav-anim">
                  <span class="menu-icon lnr lnr-book"></span>
                  <span class="link-text">Blog</span>
                </a>
              </li>
              <li>
                <a href="index.html#contact" class="nav-anim">
                  <span class="menu-icon lnr lnr-envelope"></span>
                  <span class="link-text">Contact</span>
                </a>
              </li>
            </ul>

            <div class="social-links">
              <ul>
  				<li><a href="#" target="_blank"><i class="fab fa-weixin"></i></a></li>
                <li><a href="mailto:leehightall@163.com" target="_blank"><i class="fa fa-envelope-open"></i></a></li>
                <li><a href="#" target="_blank"><i class="fab fa-qq"></i></a></li>
              </ul>
            </div>

            <div class="header-buttons">
              <a href="./paper/Haitao_Li-CV.docx" target="_blank" class="btn btn-primary">Download CV</a>
            </div>
          
          </header>

          <!-- Mobile Navigation -->
          <div class="menu-toggle">
            <span></span>
            <span></span>
            <span></span>
          </div>
          <!-- End Mobile Navigation -->

          <div class="content-area single-page-area">
            <div class="single-page-content">

              <article class="post">

                <div class="post-thumbnail">
                  <img src="img/fengmian.jpg" alt="image" width="1500" height="400">
                </div>

                <div class="post-content">
                  <!-- /Entry header -->
                  <header class="entry-header">
                    <!-- Entry meta -->
                    <div class="entry-meta entry-meta-top">
                      <span><a href="#" rel="category tag">Bioinformatics Tools</a></span>        
                    </div>
                    <!-- /Entry meta -->

                    <h2 class="entry-title" align="middle">IMPUTE2基因型填充详细过程(1)</h2>
                  </header>
                  <!-- /Entry header -->

                  <!-- Entry content -->
                  <div class="entry-content">
                    <div class="row">
                      <div class=" col-xs-12 col-sm-12 ">
                        <div class="col-inner">
                          <p>IMPUTE2是基因型填充软件，原理图如下图所示</p>
 <p><img src="img/Blog_1/image001.png" align="middle">&nbsp;</img></p>
<p>使用HapMap或者是千人基因组数据作为参考单倍型，对所研究的缺失基因型进行填充。填充所涉及的核心算法为MCMC算法。具体软件介绍请见网页：http://mathgen.stats.ox.ac.uk/impute/impute_v2.html</p>

<h3> 实例演示</h3>
<p>填充ADNI数据库中轻度认知障碍（MCI）人群的单倍体型。</p>
<p>一、下载SNP数据，对数据进行质量控制后，生成文件储存在/mnt/disk/hightall/impute_SNP/AD _MCI中，初始文件为：（1）ADNI1_QC.bed；（2）ADNI1_QC.bim；（3）ADNI1_QC.fam
通过plink软件将文件转换为ADNI_QC_recode.ped和ADNI_QC_recode.map，具体的执行命令为：</p>
<blockquote class="quote">plink --bfile ADNI1_QC --recode --out ADNI_QC_recode
                          </blockquote>
<p>二、由于ADNI数据库中的数据是hg18，因此需要使用liftover对数据进行修正为hg19。执行过程：</p>
<p>在网站：http://genome.sph.umich.edu/wiki/LiftOver中下载程序LiftMap.py和liftover，将这两个文件保存在/mnt/disk/hightall/impute_SNP/AD _MCI中，执行</p>
<blockquote class="quote"> python LiftMap.py -m ADNI_QC_recode.map -p ADNI_QC_recode.ped -o ADNI_QC_liftover </blockquote>
<p>以下是Python程序的部分截图，需要用到的文件在上面网址下载，将地址改变为实际地址<p>
  <p><img src="img/Blog_1/image003.png" align="middle">&nbsp;</img></p>
<p>在liftover前有节点为507090，在执行程序后，剩余506341，删除了749个节点。</p>
<p>将所有染色体分开（文件名为.ped和.map）并且生成例如ADNI1_QC_chr1.ped,ADNI1_QC_chr1. map和ADNI1_QC_chr1.log。执行程序：<p>
<blockquote class="quote"> for chr in {1..22};do plink --file ADNI_QC_liftover --chr ${chr} --recode --out ./chr_seq/ADNI1_QC_chr${chr};done</blockquote>

<p>三、使用gtool软件对数据进行处理，将文件处理成适合SHAPEIT的文件，命名为ADNI1_QC_chr1.sample和ADNI1_QC_chr1.gen.具体执行命令为：<p>
<blockquote class="quote">for chr in {1..22};do gtool -P --ped chr_seq/ADNI1_QC_chr${chr}.ped --map chr_seq/ADNI1_QC_chr${chr}.map --og chr_seq/ADNI1_QC_chr${chr}.gen --os chr_seq/ADNI1_QC_chr${chr}.sample;done</blockquote>
<p>同时，为了实现下一步shapeit的程序执行，需要生成.bed/.bim/.fam文件，这里需要执行：</p>
<blockquote class="quote">for chr in {1..22};do plink --gen ADNI1_QC_chr${chr}.gen --sample ADNI1_QC_chr${chr}.sample --make-bed --out ADNI1_QC_chr${chr};done</blockquote>
<p>使用shapeit软件对新生成的ADNI_QC_recode.sample和ADNI_QC_recode.gen进行相型（phase）分配，这里运行命令：</p>
<blockquote class="quote">for chr in {1..22};do ./shapeit_phasing_job.sh ${chr};done</blockquote>
<p>其中，shapeit_phasing_job.sh文件是由网站：http://genome.sph.umich.edu/wiki/IMPUTE2:_1000_Genomes_Imputation_Cookbook 中的文件，程序的节选如下图所示</p>
   <p><img src="img/Blog_1/image005.png" align="middle">&nbsp;</img></p>
<p>执行程序后生成.haps/.sample/.log文件，结果存储在results_shapeit文件夹中。</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /Entry content -->
    
                  <div class="entry-meta entry-meta-bottom">
                    <div class="date-author">
                      <span class="entry-date">
                        <a href="#" rel="bookmark">
                          <i class="far fa-clock"></i> <span class="entry-date"> March 05, 2017</span>
                        </a>
                      </span>
                      <span class="author vcard">
                        <a class="url fn n" href="#" rel="author"> <i class="fas fa-user"></i> Hai-Tao Li</a>
                      </span>
                    </div>
      
                    <!-- Share Buttons -->
                    <div class="entry-share btn-group share-buttons"> </div>
                    <!-- /Share Buttons -->
                  </div>

                  <div class="post-tags">
                    <div class="tags">
                      <a href="#" rel="tag">SNP</a>
                      <a href="#" rel="tag">Impute2</a>
                      <a href="#" rel="tag">genotype</a>
                      <a href="#" rel="tag">bioinformatics tool</a>
                      <a href="#" rel="tag">GWAS</a>
                    </div>
                  </div>
                </div>
              </article>

            </div>
          </div>

      </div>
    </div>

    <script src="js/jquery-2.1.3.min.js"></script>
    <script src="js/modernizr.custom.js"></script>
    <script src="js/animating.js"></script>

    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>

    <script src='js/perfect-scrollbar.min.js'></script>
    <script src='js/jquery.shuffle.min.js'></script>
    <script src='js/masonry.pkgd.min.js'></script>
    <script src='js/owl.carousel.min.js'></script>
    <script src="js/jquery.magnific-popup.min.js"></script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrDf32aQTCVENBhFJbMBKOUTiUAABtC2o"></script>
    <script src="js/jquery.googlemap.js"></script>
    <script src="js/validator.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
